# 커피자판기

### 모듈 import

```python
import pickle
```



## 커피 자판기 기본 세팅

```python
coffee_set = {'coffee': 0, 'money':{'100' : 0, '500' : 0, '1000' : 0, '5000' : 0, 
                                    '10000':0}, 'total':0}
# 커피 자판기 기본 세팅
with open('coffee_m.txt', 'wb') as f:
    pickle.dump(coffee_set, f)
```



## 기본 설정(가격, 클래스 생성)

```python
# 기본 설정
i = 0
cf_price = 500

# 파일 마지막 내용 저장, 오픈 class
class file():
    def save(self, li):
        with open('coffee_m.txt', 'ab') as f:
            pickle.dump(li, f)

    def open_(self, file_name):
        data_li = []
        with open(file_name, 'rb') as f:
                a = 0
                while a == 0 :
                    try: 
                        data=pickle.load(f)
                        data_li.append(data)
                    except :
                        a = 1
        return data_li

# 거스름돈, 받은 돈 계산하여 자판기에 저장할 수 있도록 list화 하는 class
class money():
    def cnt(self, n):
        money_li = []
        n = int(n)
        money10000 = divmod(n,10000)[0]
        money5000 = divmod(n-money10000*10000,5000)[0]
        money1000 = divmod(n-money10000*10000-money5000*5000,1000)[0]
        money500 = divmod(n-money10000*10000-money5000*5000-money1000*1000,500)[0]
        money100 = divmod(n-money10000*10000-money5000*5000-money1000*1000-money500*500, 100)[0]
        money_li.append(money10000)
        money_li.append(money5000)
        money_li.append(money1000)
        money_li.append(money500)
        money_li.append(money100)
        return money_li

    def re(self, last, money_li):
        last['money']['10000'] = last['money']['10000'] + money_li[0]
        last['money']['5000'] = last['money']['5000'] + money_li[1]
        last['money']['1000'] = last['money']['1000'] + money_li[2]
        last['money']['500'] = last['money']['500'] + money_li[3]
        last['money']['100'] = last['money']['100'] + money_li[4]
        return
    
# class 불러오기
mn = money()
f = file()
```



## 작동

```python
mode = input('어서오세요 사용 모드를 선택해주세요 1. 관리자 모드 2. 사용자 모드 3. 종료: ')

# 관리자 모드
if mode == '1':
    pw = input('관리자 비밀번호를 입력해주세요 : ')
    
    # 비밀번호 입력 성공 시 관리자 페이지로 접속
    while True :
        if pw == '1234':
            while True :
                do = input('1. 커피 추가 2. 동전 투입 3. 총 수익금 확인 4. 종료 : ')
                
                # 커피 추가 -> 입력 -> 파일저장
                if do == '1':
                    n_set = f.open_('coffee_m.txt')
                    last = n_set[-1]
                    cf = int(input('현재 커피는 {}잔 있습니다 커피를 몇 잔 추가하시겠습니까? : '.format(last['coffee'])))
                    last['coffee'] = last['coffee'] + cf
                    f.save(last)
                    print('추가가 완료되었습니다. 관리자 모드 선택 페이지로 이동합니다.')
                    continue
                
                # 동전 투입 -> 입력(100:10, 형태로) -> 저장
                elif do == '2':
                    n_set = f.open_('coffee_m.txt')
                    last = n_set[-1]
                    m = last['money']
                    print('현재 100원 {0}, 500원 {1}, 1000원 {2}, 5000원 {3}, 10000원 {4}이 있습니다\n'.format(m['100'],
                                                                                                  m['500'],m['1000'],
                                                                                                  m['5000'],m['10000']))
                    mn = input('추가할 동전과 갯수를 입력해주세요 : ')
                    mn_li = list(mn.split(','))
                    for i in mn_li :
                        money, cnt = i.split(':')
                        last['money'][money] =  last['money'][money] + int(cnt)
                    f.save(last)
                    print('추가가 완료되었습니다. 관리자 모드 선택 페이지로 이동합니다.')
                    continue
                
                # total 계산 출력
                elif do == '3':
                    n_set = f.open_('coffee_m.txt')
                    last = n_set[-1]
                    print("수익 : {}원".format(last['total']))
                    print('출력이 완료되었습니다. 관리자 모드 선택 페이지로 이동합니다.')
                    continue
                
                # 관리자 모드 종료
                elif do == '4':
                    print('관리자 모드를 종료합니다.')
                    break
            break
        
        # 관리자 번호를 잘못 입력했을 시
        else :
            pw_ask = input('관리자 비밀번호를 잊어버리셨습니까? 1. yes 2. no : ')
            if pw_ask == '1':
                print('관리자 모드를 종료합니다.')
                break
            elif pw_ask == '2':
                print('관리자 비밀번호를 재입력 해주세요')
                pw = input('관리자 비밀번호를 입력해주세요 : ')
                continue

# 사용자 모드
elif mode == '2':
    
    # 금액 넣고 -> 구매할 잔 수 입력
    use_money = int(input('금액을 넣어주세요 : '))
    use_coffee = int(input('구매하실 잔 수를 입력해주세요 : '))
    use_want = use_coffee*cf_price
    n_set = f.open_('coffee_m.txt')
    last = n_set[-1]
    
    while True :
        
        # 커피 부족 시 관리자 문의 번호 출력
        if use_coffee > last['coffee']:
            print('죄송합니다. 커피가 부족합니다 관리자에게 문의하십시오 000-0000')
            break
            
        # 투입한 금액보다 실제 커피 금액이 더 클 경우 -> 금액 부족 문구 출력 (금액 추가 or 자판기 종료)
        elif use_money < use_want :
            add_nm = use_want - use_money
            no_nm = input('금액이 {}원 부족합니다 추가로 넣으시겠습니까? 1. yes 2. no : '.format(cf_price - use_money))
            if no_nm == '1':
                use_mn_plus = input('금액을 추가로 넣어주세요 : ')
                use_money += int(use_mn_plus)
                continue

            elif no_nm == '2':
                print('자판기를 종료합니다. {}원이 반환됩니다.'.format(use_money))
                break
            
        # 투입한 금액이 실제 커피 금액보다 클 경우 (정상 작동)
        elif use_money >= use_want:
            last['coffee'] = last['coffee'] - use_coffee
            last['total'] = last['total'] + use_want
            
            money_li = mn.cnt(use_money)
            change = use_money - use_want
            ch_li = mn.cnt(change)
    
            for i in range(len(money_li)):
                money_li[i] = abs(money_li[i]-ch_li[i])
                
            mn.re(last, money_li)
            
            # 커피 구매 완료 후 거스름돈 반환 -> 추가 구매여부 질문
            print('커피 구매가 완료되었습니다. {}원이 반환됩니다.'.format(change))
            re_ask = input('감사합니다 추가로 구매하시겠습니까? 1. yes 2. no : ')
            f.save(last)
            
            if re_ask == '1':
                use_money = input('금액을 넣어주세요 : ')
                use_coffee = input('구매하실 잔 수를 입력해주세요 : ')
                use_coffee = int(use_coffee)
                use_money = int(use_money)
                use_want = use_coffee*cf_price
                continue
                
            elif re_ask =='2':
                print('자판기를 종료합니다. 안녕히 가십시오.')
                break
                
```

